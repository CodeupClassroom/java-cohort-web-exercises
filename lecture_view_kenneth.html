<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>kh Lecture View</title>

    <style>

    </style>
</head>
<body>

<!--Overview example : using API call-->
<!--<h1>Want a recipe?</h1>-->
<!--<button id="genRecipe">Click me</button>-->

<!--<p id="main"><span id="recipeTitle">I'll be replaced with a recipe when you click above. :)</span>-->
<!--<br>-->
<!--<br>-->
<!--<br>-->
<!--<span id="recipeBody"></span></p>-->

<!--Requests and Response : taking it to .json file -->

<h1>Here's some stories I like:</h1>

<div id="content">

</div>

<h1>Care to add a story?</h1>

<form>

    <label for="title">Title of work:</label>
    <input type="text" name="title" id="title">

    <br>
    <label for="author">Author name:</label>
    <input type="text" name="author" id="author">

    <br>
    <label for="year">Year published</label>
    <input type="text" name="year" id="year">

    <button type="button" id="submitNew">Submit</button>
</form>

<script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>

<!--<script src="js/jquery_attributes.js"></script>-->

<script>
<!--    Overview example : API call -->
    // $("#genRecipe").click(function(){
    //
    //
    //     $.ajax("https://www.themealdb.com/api/json/v1/1/random.php").done(function(data){
    //
    //         $("#recipeTitle").text(data.meals[0].strMeal);
    //
    //         $("#recipeBody").text(data.meals[0].strInstructions);
    //
    //
    //         console.log(data);
    //     })
    //
    //
    //
    // })

let innerHTML = "";

//.done - happy path, I finished. . [get, post, etc] to the URL you gave me, and now I'll execute this function

//.fail - unhappy path, I was unable to finish your request

//.always - I will always [happy or unhappy] do these instructions

$.ajax("js/ajax-books.json")
    .done(function(data, status){

        console.log(status);

        data.forEach(function(book){
        innerHTML += `<p>${book.title} : by ${book.author}; published in ${book.year}</p>`
    })

    $("#content").html(innerHTML);
})
    .fail(function(status, error){
        console.log(status);
        console.log(error);
    })
    .always(function(){
        alert("Request complete - check success or fail in log");
    })


$("#submitNew").click(function(){

    var myObj =  {
        title: $("#title").val(),
        author: $("#author").val(),
        year: parseInt($("#year").val())

    }

    $.ajax({
        url: "https://www.toptal.com/developers/postbin/1666629078713-7818122375756",
        method: "POST",
        dataType: "jsonp",
        data: myObj
    }).done(function(data, success){
        console.log(data);
        console.log(success);
    })
})

</script>
</body>
</html>